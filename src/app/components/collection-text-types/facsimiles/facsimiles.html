<div *ngIf="externalFacsimiles.length > 0 || facsimiles.length > 0 && (showTitle || facsimiles.length > 1 || externalFacsimiles.length > 0)"
      class="text-select-wrapper facsimile-header"
      [class.external-urls-header]="selectedFacsimileIsExternal"
      [class.facs-change-possible]="facsimiles.length > 1 || (facsimiles.length == 1 && externalFacsimiles.length > 0)"
      [class.facs-title-shown]="!selectedFacsimileIsExternal && showTitle"
      [class.mobile-mode]="userSettingsService.isMobile()"
>
  <h3 *ngIf="!selectedFacsimileIsExternal && showTitle" [innerHTML]="selectedFacsimile.title"></h3>
  <h3 *ngIf="selectedFacsimileIsExternal" i18n="@@Read.Facsimiles.ExternalHeading">Externa faksimil</h3>
  <div *ngIf="facsimiles.length > 1 || (facsimiles.length == 1 && externalFacsimiles.length > 0)"
        class="flex-buttons"
  >
    <ion-button class="custom-button" (click)="presentSelectFacsimileAlert()"
          i18n="@@Read.Facsimiles.ChangeFacsimile"
    >Byt faksimil</ion-button>
  </div>
</div>

<div *ngIf="selectedFacsimileIsExternal"
      class="external-urls-wrapper tei teiContainer"
      [class.mobile-mode]="userSettingsService.isMobile()"
      [ngClass]="(readPopoverService.fontsize==0)?'xsmallFontSize':(readPopoverService.fontsize==1)?'smallFontSize':(readPopoverService.fontsize==2)?'mediumFontSize':(readPopoverService.fontsize==3)?'largeFontSize':'xlargeFontSize'"
>
  <ul>
    <li *ngFor="let ext of externalFacsimiles">
      <a target="_blank" [href]="ext.url" [innerHTML]="ext.title"></a>
    </li>
  </ul>
</div>

<ion-input *ngIf="!selectedFacsimileIsExternal && numberOfImages && numberOfImages > 1"
      class="image-nr-input"
      [class.mobile-mode]="userSettingsService.isMobile()"
      fill="solid"
      label="Bild:"
      i18n-label="@@Read.Facsimiles.Page"
      [helperText]="numberOfImages ? '/ ' + numberOfImages : ''"
      type="number"
      inputmode="numeric"
      min="1"
      [max]="numberOfImages ? numberOfImages : null"
      (ionChange)="setImageNr($event)"
      [(ngModel)]="facsNumber"
></ion-input>

<div *ngIf="facsNumber && !selectedFacsimileIsExternal && selectedFacsimile" class="facsimile-image-wrapper">
  <img
        [src]="
              facsURLAlternate
              ? facsURLAlternate+'/'+selectedFacsimile.publication_facsimile_collection_id+'/'+facsSize+'/'+facsNumber+'.jpg'
              : facsURLDefault+facsNumber+(facsSize ? '/'+facsSize : '')
              "
        alt="Skannat faksimil"
        i18n-alt="@@Read.Facsimiles.AltText"
        loading="lazy"
        [ngStyle]="{'transform':'scale('+zoom+') translate3d('+prevX+'px, '+prevY+'px, 0px) rotate('+angle+'deg)'}"
        (wheel)="zoomWithMouseWheel($event)"
        [draggableImage]="[prevX, prevY]"
        [angle]="angle"
        [zoom]="zoom"
        (finalCoordinates)="setImageCoordinates($event)"
  >
</div>

<ng-container *ngIf="facsimiles.length>0">
  <ion-fab *ngIf="numberOfImages && numberOfImages > 1 && !selectedFacsimileIsExternal" class="left-facs-controls">
    <ion-fab-button
          class="primary-fab-button"
          size="small"
          (click)="previous()"
          title="Föregående bild"
          i18n-title="@@Read.Facsimiles.Previous"
    >
      <ion-icon name="arrow-back" aria-label="Föregående bild" i18n-aria-label="@@Read.Facsimiles.Previous"></ion-icon>
    </ion-fab-button>
  </ion-fab>
  <ion-fab *ngIf="!selectedFacsimileIsExternal" class="right-facs-controls">
    <ion-fab-button *ngIf="numberOfImages && numberOfImages > 1"
          class="primary-fab-button"
          size="small"
          (click)="next()"
          title="Följande bild"
          i18n-title="@@Read.Facsimiles.Next"
    >
      <ion-icon name="arrow-forward" aria-label="Följande bild" i18n-aria-label="@@Read.Facsimiles.Next"></ion-icon>
    </ion-fab-button>
    <ion-fab-button size="small" (click)="openFullScreen()" title="Visa i helskärmsläge" i18n-title="@@Read.Facsimiles.Fullscreen" aria-haspopup="dialog">
      <ion-icon name="expand-outline" aria-label="Visa i helskärmsläge" i18n-aria-label="@@Read.Facsimiles.Fullscreen"></ion-icon>
    </ion-fab-button>
    <ion-fab-button size="small" (click)="zoomIn()" title="Zooma in" i18n-title="@@Read.Facsimiles.ZoomIn">
      <ion-icon name="add-outline" aria-label="Zooma in" i18n-aria-label="@@Read.Facsimiles.ZoomIn"></ion-icon>
    </ion-fab-button>
    <ion-fab-button size="small" (click)="zoomOut()" title="Zooma ut" i18n-title="@@Read.Facsimiles.ZoomOut">
      <ion-icon name="remove-outline" aria-label="Zooma ut" i18n-aria-label="@@Read.Facsimiles.ZoomOut"></ion-icon>
    </ion-fab-button>
    <ion-fab-button size="small" (click)="rotate()" title="Rotera" i18n-title="@@Read.Facsimiles.Rotate">
      <ion-icon name="refresh-outline" aria-label="Rotera" i18n-aria-label="@@Read.Facsimiles.Rotate"></ion-icon>
    </ion-fab-button>
    <ion-fab-button size="small" (click)="reset()" title="Återställ" i18n-title="@@Read.Facsimiles.Reset">
      <ion-icon name="scan-outline" aria-label="Återställ" i18n-aria-label="@@Read.Facsimiles.Reset"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ng-container>

<div *ngIf="text" class="tei teiContainer" [innerHTML]="text"
  [ngClass]="(readPopoverService.fontsize==0)?'xsmallFontSize':(readPopoverService.fontsize==1)?'smallFontSize':(readPopoverService.fontsize==2)?'mediumFontSize':(readPopoverService.fontsize==3)?'largeFontSize':'xlargeFontSize'">
</div>
